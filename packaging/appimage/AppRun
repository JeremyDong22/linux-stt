#!/bin/bash
# AppRun - Entry point for Linux STT AppImage
# Launches the GUI

APPDIR="$(dirname "$(readlink -f "$0")")"

# Set up environment
export PATH="$APPDIR/usr/bin:$PATH"
export LD_LIBRARY_PATH="$APPDIR/usr/lib:$LD_LIBRARY_PATH"
export PYTHONHOME="$APPDIR/usr"
export PYTHONPATH="$APPDIR/usr/lib/python3.11/site-packages:$PYTHONPATH"
export LINUX_STT_MODEL_PATH="$APPDIR/usr/share/linux-stt/models/iic/SenseVoiceSmall"

# Launch GUI (or CLI if --cli flag)
if [ "$1" = "--cli" ]; then
    shift
    exec "$APPDIR/usr/bin/python3" -m linux_stt.main "$@"
else
    exec "$APPDIR/usr/bin/python3" -m linux_stt.gui "$@"
fi
